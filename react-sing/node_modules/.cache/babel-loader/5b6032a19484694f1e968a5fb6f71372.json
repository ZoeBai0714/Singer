{"ast":null,"code":"var _jsxFileName = \"/Users/xuebai/flatiron/Singer/react-sing/src/App.js\";\nimport React from 'react';\nimport SearchBar from './Component/SearchBar';\nimport SongList from './Component/SongList';\nimport Recorder from './Component/Recorder';\nimport Comment from './Component/Comment';\nimport socketIO from 'socket.io-client'; //const io = socketIO('localhost:3000/')\n\nconst io = socketIO('http://10.185.5.84:3000/');\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      songIds: [],\n      record: false,\n      handle: \"\",\n      comment: \"\" // pass videoIds to songList \n\n    };\n\n    this.songList = songIds => {\n      this.setState({\n        songIds: songIds\n      });\n    };\n\n    this.reaction = e => {\n      e.preventDefault();\n      io.emit('comment', {\n        message: e.target.children[2].value,\n        handle: e.target.children[0].value\n      });\n      this.setState({\n        handle: e.target.children[0].value,\n        comment: e.target.children[2].value\n      });\n    };\n\n    this.abort = () => {\n      io.emit('abort');\n    };\n\n    this.sendAudioBuffer = bufferData => {\n      //convert buffer data\n      //console.log(bufferData)\n      io.emit('audioBuffer', bufferData);\n    };\n  }\n\n  componentDidMount() {\n    var sourceBuffer, audioElement, mediaSource;\n    io.on('comment', messageData => {\n      const commentArea = document.getElementById('output');\n      return commentArea.innerHTML += '<p>' + messageData.handle + ':' + messageData.message + '</p>';\n    });\n    io.on('audioBuffer', arrayBuffer => {\n      if (sourceBuffer && !sourceBuffer.updating) sourceBuffer.appendBuffer(arrayBuffer);\n    });\n    io.on('abort', () => {\n      sourceOpen();\n    });\n\n    function sourceOpen() {\n      audioElement = document.createElement('audio');\n      mediaSource = new MediaSource();\n      audioElement.src = URL.createObjectURL(mediaSource);\n      audioElement.autoplay = true;\n      mediaSource.addEventListener('sourceopen', e => {\n        var mime = \"audio/webm;codecs=opus\";\n        var mediaSource = e.target;\n        sourceBuffer = mediaSource.addSourceBuffer(mime);\n      });\n    }\n\n    sourceOpen();\n  }\n\n  // {\n  //   bufferData: bufferData\n  // }\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(SearchBar, {\n      songList: this.songList,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }), React.createElement(SongList, {\n      songIds: this.state.songIds,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }), React.createElement(Recorder, {\n      sendAudioBuffer: this.sendAudioBuffer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }), React.createElement(Comment, {\n      reaction: this.reaction,\n      handle: this.state.handle,\n      comment: this.state.comment\n      /*displayComments = {this.displayComments}*/\n      ,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default App;\n/*\nconst handleSubmit = (e) =>{\n  e.preventDefault()\n  let request = gapi.client.youtube.search.list({\n    part:\"snippet\",\n    channelId:\"UCwTRjvjVge51X-ILJ4i22ew\",\n    q:e.target.value\n  })\n}\n const init = () =>{\n  gapi.client.setApiKey(\"AIzaSyBlG_6DX-JMovaElRRI4KqXl_k0KAyHH_0\");\n  gapi.client.load(\"youtube\", \"v3\", function(){\n   })\n}\n*/","map":{"version":3,"sources":["/Users/xuebai/flatiron/Singer/react-sing/src/App.js"],"names":["React","SearchBar","SongList","Recorder","Comment","socketIO","io","App","Component","state","songIds","record","handle","comment","songList","setState","reaction","e","preventDefault","emit","message","target","children","value","abort","sendAudioBuffer","bufferData","componentDidMount","sourceBuffer","audioElement","mediaSource","on","messageData","commentArea","document","getElementById","innerHTML","arrayBuffer","updating","appendBuffer","sourceOpen","createElement","MediaSource","src","URL","createObjectURL","autoplay","addEventListener","mime","addSourceBuffer","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport SearchBar from './Component/SearchBar'\nimport SongList from './Component/SongList'\nimport Recorder from './Component/Recorder'\nimport Comment from './Component/Comment'\nimport socketIO from 'socket.io-client';\n//const io = socketIO('localhost:3000/')\nconst io = socketIO('http://10.185.5.84:3000/')\n\nclass App extends React.Component {\n  state = {\n    songIds: [],\n    record: false,\n    handle: \"\",\n    comment: \"\"\n  }\n\n  // pass videoIds to songList \n  songList = (songIds) => {\n    this.setState({\n      songIds: songIds\n    })\n  }\n\n  reaction = (e) => {\n    e.preventDefault()\n    io.emit('comment', {\n      message: e.target.children[2].value,\n      handle: e.target.children[0].value,\n    })\n    this.setState({\n      handle: e.target.children[0].value,\n      comment: e.target.children[2].value\n    })\n  }\n\n\n\n\n  componentDidMount() {\n    var sourceBuffer, audioElement, mediaSource\n    io.on('comment', messageData => {\n      const commentArea = document.getElementById('output')\n      return commentArea.innerHTML += '<p>' + messageData.handle + ':' + messageData.message + '</p>'\n    })\n   \n    io.on('audioBuffer', (arrayBuffer) => {\n      if(sourceBuffer && !sourceBuffer.updating) sourceBuffer.appendBuffer(arrayBuffer);\n    })\n\n    io.on('abort', () =>{\n      sourceOpen()\n    })\n\n\n    function sourceOpen(){ \n      audioElement = document.createElement('audio');\n      mediaSource = new MediaSource();\n      audioElement.src = URL.createObjectURL(mediaSource);\n      audioElement.autoplay = true\n      mediaSource.addEventListener('sourceopen', e => {\n        var mime = \"audio/webm;codecs=opus\";\n        var mediaSource = e.target;\n        sourceBuffer = mediaSource.addSourceBuffer(mime);        \n      });\n    }\n    sourceOpen()\n  }\n\n  abort = () =>{\n   io.emit('abort')\n  }\n\n  sendAudioBuffer = bufferData => {\n    //convert buffer data\n    //console.log(bufferData)\n    io.emit('audioBuffer', bufferData)\n  }\n  // {\n  //   bufferData: bufferData\n  // }\n  render() {\n    return (\n      <div>\n        <SearchBar songList={this.songList} />\n        <SongList songIds={this.state.songIds} />\n        <Recorder sendAudioBuffer={this.sendAudioBuffer} />\n        <Comment reaction={this.reaction} handle={this.state.handle} comment={this.state.comment}  /*displayComments = {this.displayComments}*/ />\n      </div>\n\n    )\n  }\n}\n\n\nexport default App;\n /*\n const handleSubmit = (e) =>{\n   e.preventDefault()\n   let request = gapi.client.youtube.search.list({\n     part:\"snippet\",\n     channelId:\"UCwTRjvjVge51X-ILJ4i22ew\",\n     q:e.target.value\n   })\n }\n\n const init = () =>{\n   gapi.client.setApiKey(\"AIzaSyBlG_6DX-JMovaElRRI4KqXl_k0KAyHH_0\");\n   gapi.client.load(\"youtube\", \"v3\", function(){\n\n   })\n}\n */"]},"metadata":{},"sourceType":"module"}